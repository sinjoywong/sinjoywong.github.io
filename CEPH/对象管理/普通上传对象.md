## 参考

https://www.talkwithtrend.com/Article/242647

https://www.codenong.com/cs106288679/



## 普通上传

### 整体上传

- 应用对象大小小于等于分块大小：用户上传的一个对象只对应一个 RADOS 对象，该 RADOS 对象以应用对象名称命名，应用对象元数据也保存在该 RADOS 对象的扩展属性中。
- 应用对象大小大于分块大小：应用对象被分解成一个大小等于分块大小的首对象，多个大小等于条带大小的中间对象，和一个大小小于等于条带大小的尾对象。首对象以应用对象名称命名，在 RGW 中将该对象称为head_obj，该对象的数据部分保存了应用对象前 rgw_max_chunk_size 字节的数据，扩展属性部分保存了应用对象的元数据信息和manifest信息。中间对象和尾对象保存应用对象剩余的数据，对象名称为“shadow_” + “.” + “32bit 随机字符串” + “_” + “条带编号”，其中条带编号从1开始。

<img src="http://img.5iqiqu.com/images5/c7/c7af176d9df9251ffa8d42ee99faed45.png" alt="img" style="zoom: 33%;" />

object有一个或多个rados object组成。逻辑上分为head和tail

head组成如下图

tail说明

| 1 2 3 | 1.对于小于rgw_max_chunk_size的rgw object没有tail 2.对于multipart上传的对象，tail分multipart（每个part 的第一个rados对象）和shadow 3.tail被分隔成若干个part，每个part默认rgw_obj_stripe_size，详见分片上传 |
| ----- | ------------------------------------------------------------ |
|       |                                                              |

<img src=".%E6%99%AE%E9%80%9A%E4%B8%8A%E4%BC%A0%E5%AF%B9%E8%B1%A1.assets/image-20210725001616354.png" alt="image-20210725001616354" style="zoom:50%;" />





## 实验

```shell

```

