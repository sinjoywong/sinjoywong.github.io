make-dist --> ceph.spec.in --> ceph.spec --> rpm打包



### ceph.spec语法

rpm内建的宏在文件/usr/lib/rpm/redhat/macros文件中有定义，这些宏基本上定义了目录路径或体系结构等等，rpm也包含了一组用于调试有问题的spec文件的宏，如下：

```shell
%{F:file_exp} ：扩展file_exp到一个文件名
%global name value ：定义一个全局宏

%files [name]
# 文件和目录的归档，rpm包真正包含的内容，$name 与package name对应，一个package生成一个rpm包,名字${name}-${version}-${release}.rpm。若没有name，则即是spec Name项。
# files是相对路径，应用宏或变量表示相对路径：

如果描述为目录，表示目录中除%exclude外的所有文件。
%defattr (-,root,root) 指定包装文件的属性，分别是(mode,owner,group)，-表示默认值，对文本文件是0644，可执行文件是0755
```



```shell
#---ceph.spec.in----
# 宏定义
%{!?python3_pkgversion: %global python3_pkgversion 3

#
%package -n python%{python3_pkgversion}-rados
Summary:	Python 3 libraries for the RADOS object store
%if 0%{?suse_version}
Group:		Development/Languages/Python
%endif
Requires:	python%{python3_pkgversion}
Requires:	librados2 = %{_epoch_prefix}%{version}-%{release}
%description -n python%{python3_pkgversion}-rados
This package contains Python 3 libraries for interacting with Cephs RADOS
object store.

%files -n python%{python3_pkgversion}-rados
%{python3_sitearch}/rados.cpython*.so
%{python3_sitearch}/rados-*.egg-info


```

